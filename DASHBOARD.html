<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Progreso - Llamados T√©cnicos 2025</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            padding: 20px;
            color: white;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .header p {
            opacity: 0.8;
            font-size: 1.1em;
        }
        
        .nav-link {
            position: fixed;
            top: 20px;
            left: 20px;
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            transition: all 0.3s;
        }
        
        .nav-link:hover {
            background: rgba(255,255,255,0.2);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .stat-card {
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-card.highlight {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .stat-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }
        
        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-label {
            opacity: 0.8;
            font-size: 1em;
        }
        
        .section {
            background: rgba(255,255,255,0.05);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
        }
        
        .section h2 {
            font-size: 1.5em;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .progress-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .progress-item {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .progress-icon {
            font-size: 2em;
            min-width: 50px;
            text-align: center;
        }
        
        .progress-info {
            flex: 1;
        }
        
        .progress-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .progress-bar-container {
            background: rgba(255,255,255,0.2);
            height: 10px;
            border-radius: 5px;
            overflow: hidden;
            margin-top: 10px;
        }
        
        .progress-bar-fill {
            height: 100%;
            border-radius: 5px;
            transition: width 0.5s;
        }
        
        .progress-bar-fill.excellent { background: linear-gradient(90deg, #4caf50, #8bc34a); }
        .progress-bar-fill.good { background: linear-gradient(90deg, #8bc34a, #cddc39); }
        .progress-bar-fill.average { background: linear-gradient(90deg, #ffc107, #ff9800); }
        .progress-bar-fill.poor { background: linear-gradient(90deg, #ff5722, #f44336); }
        
        .progress-percentage {
            font-weight: bold;
            min-width: 60px;
            text-align: right;
        }
        
        .history-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .history-table th,
        .history-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .history-table th {
            opacity: 0.7;
            font-weight: normal;
        }
        
        .badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
        }
        
        .badge.excellent { background: #4caf50; }
        .badge.good { background: #8bc34a; }
        .badge.average { background: #ffc107; color: #333; }
        .badge.poor { background: #f44336; }
        
        .chart-container {
            height: 200px;
            display: flex;
            align-items: flex-end;
            gap: 10px;
            padding: 20px 0;
        }
        
        .chart-bar {
            flex: 1;
            background: linear-gradient(180deg, #667eea, #764ba2);
            border-radius: 5px 5px 0 0;
            min-height: 10px;
            position: relative;
            transition: height 0.5s;
        }
        
        .chart-bar:hover {
            opacity: 0.8;
        }
        
        .chart-bar::after {
            content: attr(data-value);
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.85em;
            opacity: 0.8;
        }
        
        .chart-labels {
            display: flex;
            gap: 10px;
        }
        
        .chart-labels span {
            flex: 1;
            text-align: center;
            font-size: 0.85em;
            opacity: 0.7;
        }
        
        .tips-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .tip {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 15px;
            display: flex;
            gap: 15px;
            align-items: flex-start;
        }
        
        .tip-icon {
            font-size: 1.5em;
        }
        
        .tip-content h4 {
            margin-bottom: 5px;
        }
        
        .tip-content p {
            opacity: 0.8;
            font-size: 0.95em;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            padding: 15px 30px;
            border: none;
            border-radius: 15px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            color: white;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }
        
        .action-btn:hover {
            transform: scale(1.05);
        }
        
        .action-btn.primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .action-btn.secondary {
            background: rgba(255,255,255,0.2);
        }
        
        .action-btn.danger {
            background: #f44336;
        }
        
        .streak-display {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }
        
        .streak-day {
            width: 30px;
            height: 30px;
            border-radius: 5px;
            background: rgba(255,255,255,0.1);
        }
        
        .streak-day.active {
            background: linear-gradient(135deg, #4caf50, #8bc34a);
        }
        
        .streak-day.today {
            border: 2px solid #ffc107;
        }
        
        .empty-state {
            text-align: center;
            padding: 50px;
            opacity: 0.7;
        }
        
        .empty-state-icon {
            font-size: 4em;
            margin-bottom: 20px;
        }
        
        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .progress-item {
                flex-direction: column;
                text-align: center;
            }
            
            .progress-percentage {
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <a href="INDEX.html" class="nav-link">‚Üê Men√∫ Principal</a>
    
    <div class="container">
        <div class="header">
            <h1>üìä Dashboard de Progreso</h1>
            <p>Seguimiento de tu preparaci√≥n para los Llamados T√©cnicos 2025</p>
        </div>
        
        <div class="stats-grid">
            <div class="stat-card highlight">
                <div class="stat-icon">üî•</div>
                <div class="stat-value" id="streak-count">0</div>
                <div class="stat-label">D√≠as de racha</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üìö</div>
                <div class="stat-value" id="total-sessions">0</div>
                <div class="stat-label">Sesiones de estudio</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">‚úÖ</div>
                <div class="stat-value" id="total-correct">0</div>
                <div class="stat-label">Respuestas correctas</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üìà</div>
                <div class="stat-value" id="avg-score">0%</div>
                <div class="stat-label">Promedio general</div>
            </div>
        </div>
        
        <div class="section">
            <h2>üéØ Progreso por Tema</h2>
            <div class="progress-list" id="topic-progress">
                <!-- Generado din√°micamente -->
            </div>
        </div>
        
        <div class="section">
            <h2>üìÖ Actividad de la Semana</h2>
            <div class="streak-display" id="week-streak">
                <!-- Generado din√°micamente -->
            </div>
            <div class="chart-container" id="week-chart">
                <!-- Generado din√°micamente -->
            </div>
            <div class="chart-labels" id="week-labels">
                <!-- Generado din√°micamente -->
            </div>
        </div>
        
        <div class="section">
            <h2>üìú Historial de Sesiones</h2>
            <div id="history-container">
                <!-- Generado din√°micamente -->
            </div>
        </div>
        
        <div class="section">
            <h2>üí° Recomendaciones</h2>
            <div class="tips-list" id="tips-container">
                <!-- Generado din√°micamente -->
            </div>
        </div>
        
        <div class="action-buttons">
            <a href="FLASHCARDS.html" class="action-btn primary">üé¥ Practicar Flashcards</a>
            <a href="PRUEBAS_INTERACTIVAS.html" class="action-btn primary">üìù Hacer Prueba</a>
            <a href="CALCULADORAS.html" class="action-btn secondary">üßÆ Calculadoras</a>
            <button class="action-btn danger" onclick="clearAllData()">üóëÔ∏è Borrar Datos</button>
        </div>
    </div>

    <script>
        // Datos de progreso por tema
        const topicData = {
            'radio-propagacion': { name: 'üì° Propagaci√≥n Radio', icon: 'üì°', sessions: 0, correct: 0, total: 0 },
            'radio-minilink': { name: 'üîß Ericsson Minilink', icon: 'üîß', sessions: 0, correct: 0, total: 0 },
            'tcp-ip': { name: 'üåê TCP/IP', icon: 'üåê', sessions: 0, correct: 0, total: 0 },
            'bert-rfc2544': { name: 'üìä BERT & RFC 2544', icon: 'üìä', sessions: 0, correct: 0, total: 0 },
            'fibra-optica': { name: 'üí° Fibra √ìptica', icon: 'üí°', sessions: 0, correct: 0, total: 0 },
            'transceptores': { name: 'üîå Transceptores', icon: 'üîå', sessions: 0, correct: 0, total: 0 }
        };
        
        // Cargar datos guardados
        function loadData() {
            // Cargar historial de flashcards
            const flashcardHistory = JSON.parse(localStorage.getItem('flashcard_history') || '[]');
            
            // Cargar historial de pruebas
            const testHistory = JSON.parse(localStorage.getItem('test_history') || '[]');
            
            // Cargar datos de temas
            const savedTopics = JSON.parse(localStorage.getItem('topic_progress') || '{}');
            Object.assign(topicData, savedTopics);
            
            return { flashcardHistory, testHistory };
        }
        
        // Calcular estad√≠sticas
        function calculateStats(data) {
            const { flashcardHistory, testHistory } = data;
            const allSessions = [...flashcardHistory, ...testHistory];
            
            let totalSessions = allSessions.length;
            let totalCorrect = 0;
            let totalQuestions = 0;
            
            allSessions.forEach(session => {
                totalCorrect += session.correct || 0;
                totalQuestions += session.total || 0;
            });
            
            const avgScore = totalQuestions > 0 ? Math.round((totalCorrect / totalQuestions) * 100) : 0;
            
            // Calcular racha
            const streak = calculateStreak(allSessions);
            
            return { totalSessions, totalCorrect, avgScore, streak };
        }
        
        // Calcular racha de d√≠as
        function calculateStreak(sessions) {
            if (sessions.length === 0) return 0;
            
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            const studyDays = new Set();
            sessions.forEach(s => {
                if (s.date) {
                    const d = new Date(s.date);
                    d.setHours(0, 0, 0, 0);
                    studyDays.add(d.getTime());
                }
            });
            
            let streak = 0;
            let checkDate = new Date(today);
            
            while (studyDays.has(checkDate.getTime())) {
                streak++;
                checkDate.setDate(checkDate.getDate() - 1);
            }
            
            return streak;
        }
        
        // Renderizar estad√≠sticas principales
        function renderMainStats(stats) {
            document.getElementById('streak-count').textContent = stats.streak;
            document.getElementById('total-sessions').textContent = stats.totalSessions;
            document.getElementById('total-correct').textContent = stats.totalCorrect;
            document.getElementById('avg-score').textContent = stats.avgScore + '%';
        }
        
        // Renderizar progreso por tema
        function renderTopicProgress() {
            const container = document.getElementById('topic-progress');
            let html = '';
            
            // Si no hay datos, mostrar temas de ejemplo con 0%
            const hasData = Object.values(topicData).some(t => t.total > 0);
            
            for (const [key, topic] of Object.entries(topicData)) {
                const percentage = topic.total > 0 ? Math.round((topic.correct / topic.total) * 100) : 0;
                let barClass = 'poor';
                if (percentage >= 90) barClass = 'excellent';
                else if (percentage >= 70) barClass = 'good';
                else if (percentage >= 50) barClass = 'average';
                
                html += `
                    <div class="progress-item">
                        <div class="progress-icon">${topic.icon}</div>
                        <div class="progress-info">
                            <div class="progress-title">${topic.name}</div>
                            <div style="font-size: 0.9em; opacity: 0.7;">
                                ${topic.correct}/${topic.total} respuestas correctas
                            </div>
                            <div class="progress-bar-container">
                                <div class="progress-bar-fill ${barClass}" style="width: ${percentage}%"></div>
                            </div>
                        </div>
                        <div class="progress-percentage">${percentage}%</div>
                    </div>
                `;
            }
            
            container.innerHTML = html;
        }
        
        // Renderizar actividad semanal
        function renderWeekActivity(data) {
            const { flashcardHistory, testHistory } = data;
            const allSessions = [...flashcardHistory, ...testHistory];
            
            const today = new Date();
            const dayNames = ['Dom', 'Lun', 'Mar', 'Mi√©', 'Jue', 'Vie', 'S√°b'];
            const weekData = [];
            
            // √öltimos 7 d√≠as
            for (let i = 6; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                date.setHours(0, 0, 0, 0);
                
                const dayName = dayNames[date.getDay()];
                const isToday = i === 0;
                
                // Contar sesiones de ese d√≠a
                const daySessions = allSessions.filter(s => {
                    if (!s.date) return false;
                    const sessionDate = new Date(s.date);
                    sessionDate.setHours(0, 0, 0, 0);
                    return sessionDate.getTime() === date.getTime();
                });
                
                let dayScore = 0;
                if (daySessions.length > 0) {
                    const dayCorrect = daySessions.reduce((sum, s) => sum + (s.correct || 0), 0);
                    const dayTotal = daySessions.reduce((sum, s) => sum + (s.total || 0), 0);
                    dayScore = dayTotal > 0 ? Math.round((dayCorrect / dayTotal) * 100) : 0;
                }
                
                weekData.push({
                    name: dayName,
                    score: dayScore,
                    sessions: daySessions.length,
                    isToday
                });
            }
            
            // Renderizar racha visual
            const streakContainer = document.getElementById('week-streak');
            streakContainer.innerHTML = weekData.map(d => 
                `<div class="streak-day ${d.sessions > 0 ? 'active' : ''} ${d.isToday ? 'today' : ''}" 
                     title="${d.name}: ${d.sessions} sesiones"></div>`
            ).join('');
            
            // Renderizar gr√°fico
            const maxScore = Math.max(...weekData.map(d => d.score), 1);
            const chartContainer = document.getElementById('week-chart');
            chartContainer.innerHTML = weekData.map(d => {
                const height = (d.score / 100) * 150 + 10;
                return `<div class="chart-bar" style="height: ${height}px" data-value="${d.score}%"></div>`;
            }).join('');
            
            // Renderizar etiquetas
            const labelsContainer = document.getElementById('week-labels');
            labelsContainer.innerHTML = weekData.map(d => `<span>${d.name}</span>`).join('');
        }
        
        // Renderizar historial
        function renderHistory(data) {
            const { flashcardHistory, testHistory } = data;
            const container = document.getElementById('history-container');
            
            // Combinar y ordenar por fecha
            const allSessions = [
                ...flashcardHistory.map(s => ({ ...s, type: 'Flashcards' })),
                ...testHistory.map(s => ({ ...s, type: 'Prueba' }))
            ].sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 10);
            
            if (allSessions.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üì≠</div>
                        <p>A√∫n no hay sesiones registradas.</p>
                        <p>¬°Comienza a practicar para ver tu progreso!</p>
                    </div>
                `;
                return;
            }
            
            let html = `
                <table class="history-table">
                    <thead>
                        <tr>
                            <th>Fecha</th>
                            <th>Tipo</th>
                            <th>Resultado</th>
                            <th>Calificaci√≥n</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            allSessions.forEach(session => {
                const date = session.date ? new Date(session.date).toLocaleDateString('es-ES', {
                    day: 'numeric',
                    month: 'short',
                    hour: '2-digit',
                    minute: '2-digit'
                }) : 'Sin fecha';
                
                const percentage = session.total > 0 ? Math.round((session.correct / session.total) * 100) : 0;
                let badgeClass = 'poor';
                let badgeText = 'Necesita pr√°ctica';
                
                if (percentage >= 90) { badgeClass = 'excellent'; badgeText = 'Excelente'; }
                else if (percentage >= 70) { badgeClass = 'good'; badgeText = 'Bien'; }
                else if (percentage >= 50) { badgeClass = 'average'; badgeText = 'Regular'; }
                
                html += `
                    <tr>
                        <td>${date}</td>
                        <td>${session.type}</td>
                        <td>${session.correct}/${session.total} (${percentage}%)</td>
                        <td><span class="badge ${badgeClass}">${badgeText}</span></td>
                    </tr>
                `;
            });
            
            html += '</tbody></table>';
            container.innerHTML = html;
        }
        
        // Renderizar recomendaciones
        function renderTips(stats) {
            const container = document.getElementById('tips-container');
            const tips = [];
            
            if (stats.streak === 0) {
                tips.push({
                    icon: 'üî•',
                    title: '¬°Comienza tu racha!',
                    text: 'Estudia hoy para iniciar una racha de d√≠as consecutivos.'
                });
            } else if (stats.streak >= 7) {
                tips.push({
                    icon: 'üèÜ',
                    title: '¬°Racha incre√≠ble!',
                    text: `Llevas ${stats.streak} d√≠as seguidos. ¬°Sigue as√≠!`
                });
            }
            
            if (stats.avgScore < 60) {
                tips.push({
                    icon: 'üìö',
                    title: 'Enf√≥cate en los fundamentos',
                    text: 'Revisa los res√∫menes de estudio antes de continuar con las pruebas.'
                });
            } else if (stats.avgScore >= 90) {
                tips.push({
                    icon: 'üåü',
                    title: '¬°Excelente dominio!',
                    text: 'Est√°s listo para los temas avanzados o la prueba integral.'
                });
            }
            
            // Encontrar tema m√°s d√©bil
            let weakestTopic = null;
            let lowestScore = 100;
            for (const [key, topic] of Object.entries(topicData)) {
                if (topic.total > 0) {
                    const score = (topic.correct / topic.total) * 100;
                    if (score < lowestScore) {
                        lowestScore = score;
                        weakestTopic = topic;
                    }
                }
            }
            
            if (weakestTopic && lowestScore < 70) {
                tips.push({
                    icon: 'üéØ',
                    title: `Refuerza: ${weakestTopic.name}`,
                    text: `Este tema tiene ${Math.round(lowestScore)}% de acierto. Dedica m√°s tiempo aqu√≠.`
                });
            }
            
            if (stats.totalSessions < 5) {
                tips.push({
                    icon: 'üí™',
                    title: 'Practica m√°s',
                    text: 'Realiza al menos 5 sesiones para obtener mejores recomendaciones.'
                });
            }
            
            // Tip por defecto
            if (tips.length === 0) {
                tips.push({
                    icon: '‚ú®',
                    title: 'Sigue practicando',
                    text: 'La constancia es la clave del √©xito. ¬°Contin√∫a as√≠!'
                });
            }
            
            container.innerHTML = tips.map(tip => `
                <div class="tip">
                    <div class="tip-icon">${tip.icon}</div>
                    <div class="tip-content">
                        <h4>${tip.title}</h4>
                        <p>${tip.text}</p>
                    </div>
                </div>
            `).join('');
        }
        
        // Borrar todos los datos
        function clearAllData() {
            if (confirm('¬øEst√°s seguro de que quieres borrar todo el historial de progreso? Esta acci√≥n no se puede deshacer.')) {
                localStorage.removeItem('flashcard_history');
                localStorage.removeItem('test_history');
                localStorage.removeItem('topic_progress');
                location.reload();
            }
        }
        
        // Inicializar
        function init() {
            const data = loadData();
            const stats = calculateStats(data);
            
            renderMainStats(stats);
            renderTopicProgress();
            renderWeekActivity(data);
            renderHistory(data);
            renderTips(stats);
        }
        
        init();
    </script>
</body>
</html>
